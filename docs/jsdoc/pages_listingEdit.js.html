<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/listingEdit.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/listingEdit.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* global setTimeout */

import { getAuth, clearAuth } from '../api/httpClient.js';
import { createListing, updateListing, getListingById, deleteListing } from '../api/listingsApi.js';
import { showLoader, hideLoader } from '../ui/loader.js';
import { showAlert } from '../ui/alerts.js';

// =========================
// URL + small helpers
// =========================

/**
 * Get the listing ID from the URL query string.
 *
 * Example: for `?id=123`, this returns `"123"`.
 *
 * @returns {string|null} Listing ID, or null if not present.
 */
const getListingIdFromQuery = () => {
  const search = window.location.search || '';
  const withoutQuestionMark = search.startsWith('?') ? search.slice(1) : search;
  const pairs = withoutQuestionMark.split('&amp;').filter(Boolean);

  for (let i = 0; i &lt; pairs.length; i += 1) {
    const pair = pairs[i];
    const parts = pair.split('=');
    const key = parts[0];
    const value = parts[1];

    if (key === 'id') {
      return decodeURIComponent(value || '');
    }
  }

  return null;
};

/**
 * Shorthand for `document.querySelector`.
 *
 * @param {string} selector - CSS selector string.
 * @returns {Element|null} First matching element or null.
 */
const qs = (selector) => document.querySelector(selector);

/**
 * Get the trimmed value from an input element.
 *
 * @param {HTMLInputElement|HTMLTextAreaElement|null} input - Input or textarea element.
 * @returns {string} Trimmed value or empty string if missing.
 */
const getTrimmedInputValue = (input) => {
  if (!input) return '';
  return String(input.value || '').trim();
};

// =========================
// Tags + media helpers
// =========================

/**
 * Build an array of tags from a comma-separated string.
 *
 * Example: "camera, lens, vintage" -> ["camera", "lens", "vintage"]
 *
 * @param {string} tagsRaw - Raw tags string from the form.
 * @returns {string[]|undefined} Array of tags, or undefined if none.
 */
const buildTagsArray = (tagsRaw) => {
  if (!tagsRaw) return undefined;

  const parts = String(tagsRaw)
    .split(',')
    .map((part) => part.trim())
    .filter(Boolean);

  if (!parts.length) return undefined;

  return parts;
};

/**
 * Build a media array from all `.sb-media-group` blocks in the form.
 *
 * Each media group has URL and alt inputs.
 *
 * @param {HTMLFormElement|null} form - Listing form element.
 * @returns {Object[]|undefined} Array of media objects, or undefined if none.
 */
const buildMediaArrayFromForm = (form) => {
  if (!form) return undefined;

  const media = [];
  const groups = form.querySelectorAll('.sb-media-group');

  groups.forEach((group) => {
    const urlInput = group.querySelector('[data-media-url]');
    const altInput = group.querySelector('[data-media-alt]');

    const url = getTrimmedInputValue(urlInput);
    const alt = getTrimmedInputValue(altInput);

    if (url) {
      const obj = { url: url };
      if (alt) {
        obj.alt = alt;
      }
      media.push(obj);
    }
  });

  if (!media.length) return undefined;
  return media;
};

// =========================
// Date helper
// =========================

/**
 * Convert an ISO date string into a `datetime-local` input value.
 *
 * Example: "2025-01-01T12:34:56.000Z" -> "2025-01-01T13:34" (depending on local time).
 *
 * @param {string} isoString - ISO date string.
 * @returns {string} A string in `YYYY-MM-DDTHH:MM` format, or empty string if invalid.
 */
const toDateTimeLocalValue = (isoString) => {
  if (!isoString) return '';

  const d = new Date(isoString);
  if (Number.isNaN(d.getTime())) return '';

  const pad = (n) => String(n).padStart(2, '0');

  const year = d.getFullYear();
  const month = pad(d.getMonth() + 1);
  const day = pad(d.getDate());
  const hours = pad(d.getHours());
  const minutes = pad(d.getMinutes());

  return `${year}-${month}-${day}T${hours}:${minutes}`;
};

// =========================
// Inline form message
// =========================

/**
 * Inline message element used to show form-level feedback.
 * @type {HTMLElement|null}
 */
const inlineMessageEl = qs('[data-listing-edit-message]');

/**
 * Clear the inline form message and hide the alert.
 *
 * @returns {void}
 */
const clearInlineMessage = () => {
  if (!inlineMessageEl) return;

  inlineMessageEl.textContent = '';
  inlineMessageEl.className = 'alert d-none';
};

/**
 * Show an inline form message above the form.
 *
 * @param {string} text - Message to display.
 * @param {'info'|'error'|'success'} [type] - Message type; changes alert color.
 * @returns {void}
 */
const showInlineMessage = (text, type) => {
  if (!inlineMessageEl) return;

  let extraClass = 'alert-info';

  if (type === 'error') {
    extraClass = 'alert-danger';
  } else if (type === 'success') {
    extraClass = 'alert-success';
  }

  inlineMessageEl.textContent = text;
  inlineMessageEl.className = 'alert ' + extraClass;
  inlineMessageEl.classList.remove('d-none');
  inlineMessageEl.setAttribute('role', 'alert');
};

// =========================
// Simple redirects
// =========================

/**
 * Redirect the user to the login page.
 *
 * @returns {void}
 */
const redirectToLogin = () => {
  window.location.href = 'login.html';
};

/**
 * Navigate back in history if possible, otherwise go to the homepage.
 *
 * @returns {void}
 */
const goBackOrHome = () => {
  if (window.history &amp;&amp; window.history.length > 1) {
    window.history.back();
  } else {
    window.location.href = 'index.html';
  }
};

// =========================
// Media group helper (used by add button + prefill)
// =========================

/**
 * Create a new media group (URL + alt inputs) inside the container.
 *
 * Used when adding extra image fields or prefilling from existing media.
 *
 * @param {HTMLElement|null} container - Container for media groups.
 * @param {HTMLElement|null} templateGroup - Existing group to clone.
 * @param {number} index - Index number for labels and ids.
 * @param {Object|null} mediaItem - Optional media object with url and alt.
 * @returns {HTMLElement|null} The newly created media group element, or null.
 */
const createMediaGroup = (container, templateGroup, index, mediaItem) => {
  if (!container || !templateGroup || !index) return null;

  const clone = templateGroup.cloneNode(true);
  clone.setAttribute('data-media-group', String(index));

  const urlInput = clone.querySelector('[data-media-url]');
  const altInput = clone.querySelector('[data-media-alt]');

  const urlLabel = clone.querySelector('label[for^="mediaUrl"]');
  const altLabel = clone.querySelector('label[for^="mediaAlt"]');

  const urlId = 'mediaUrl' + index;
  const altId = 'mediaAlt' + index;

  if (urlInput) {
    urlInput.id = urlId;
    urlInput.name = 'mediaUrl' + index;
    urlInput.value = mediaItem &amp;&amp; mediaItem.url ? mediaItem.url : '';
  }

  if (altInput) {
    altInput.id = altId;
    altInput.name = 'mediaAlt' + index;
    altInput.value = mediaItem &amp;&amp; mediaItem.alt ? mediaItem.alt : '';
  }

  if (urlLabel) {
    urlLabel.setAttribute('for', urlId);
  }
  if (altLabel) {
    altLabel.setAttribute('for', altId);
  }

  container.appendChild(clone);
  return clone;
};

// =========================
// Prefill form when editing
// =========================

/**
 * Prefill the form fields with data from an existing listing.
 *
 * - Title, description, tags
 * - End date/time
 * - All media items
 *
 * @param {Object} listing - Listing data from the API.
 * @returns {void}
 */
const prefillFormFromListing = (listing) => {
  if (!listing) return;

  const titleInput = qs('#listingTitle');
  const descriptionInput = qs('#listingDescription');
  const tagsInput = qs('#listingTags');
  const endsAtInput = qs('#listingEndsAt');

  if (titleInput) titleInput.value = listing.title || '';
  if (descriptionInput) descriptionInput.value = listing.description || '';

  if (tagsInput &amp;&amp; Array.isArray(listing.tags)) {
    tagsInput.value = listing.tags.join(', ');
  }

  if (endsAtInput &amp;&amp; listing.endsAt) {
    endsAtInput.value = toDateTimeLocalValue(listing.endsAt);
  }

  // Prefill ALL media items

  const media = Array.isArray(listing.media) ? listing.media.filter(Boolean) : [];
  const container = qs('#mediaFieldsContainer');
  const firstGroup = container ? container.querySelector('.sb-media-group') : null;

  if (!container || !firstGroup) return;

  if (!media.length) {
    // No media: leave first group empty
    const urlInput = firstGroup.querySelector('[data-media-url]');
    const altInput = firstGroup.querySelector('[data-media-alt]');
    if (urlInput) urlInput.value = '';
    if (altInput) altInput.value = '';
    return;
  }

  // Fill first group with first media item

  const firstItem = media[0] || {};
  const firstUrlInput = firstGroup.querySelector('[data-media-url]');
  const firstAltInput = firstGroup.querySelector('[data-media-alt]');
  if (firstUrlInput) firstUrlInput.value = firstItem.url || '';
  if (firstAltInput) firstAltInput.value = firstItem.alt || '';

  // Remove any extra groups that may be present from previous usage

  const extraGroups = container.querySelectorAll('.sb-media-group:not(:first-child)');
  extraGroups.forEach((group) => group.remove());

  // Add remaining media items as new groups

  for (let i = 1; i &lt; media.length; i += 1) {
    const index = i + 1; // since first is 1
    createMediaGroup(container, firstGroup, index, media[i]);
  }
};

// =========================
// Button layout (create vs edit)
// =========================

/**
 * Show the correct button row depending on mode:
 * - Create mode: show create row
 * - Edit mode: show edit row
 *
 * @param {boolean} isEditMode - True if editing an existing listing.
 * @returns {void}
 */
const setupButtonsForMode = (isEditMode) => {
  const createButtonsRow = qs('#createModeButtons');
  const editButtonsRow = qs('#editModeButtons');

  if (createButtonsRow) {
    createButtonsRow.classList.toggle('d-none', isEditMode);
  }
  if (editButtonsRow) {
    editButtonsRow.classList.toggle('d-none', !isEditMode);
  }
};

// =========================
// Delete listing
// =========================

/**
 * Set up the delete button in edit mode.
 *
 * - Confirms with the user
 * - Calls the delete listing API
 * - Redirects to profile page afterwards
 *
 * @param {string|null} listingId - ID of the listing being edited.
 * @returns {void}
 */
const setupDeleteInEditMode = (listingId) => {
  const editButtonsRow = qs('#editModeButtons');
  if (!editButtonsRow || !listingId) return;

  const deleteBtn = editButtonsRow.querySelector('.btn-danger');
  if (!deleteBtn) return;

  deleteBtn.addEventListener('click', async () => {
    const confirmed = window.confirm('Are you sure you want to delete this listing?');
    if (!confirmed) return;

    showLoader();
    deleteBtn.disabled = true;

    try {
      await deleteListing(listingId);

      showAlert('success', 'Listing deleted', 'Your listing has been deleted.');

      setTimeout(() => {
        window.location.href = 'profile.html#my-listings';
      }, 800);
    } catch (error) {
      const msg =
        error &amp;&amp; error.message ? error.message : 'Could not delete this listing. Please try again.';
      showAlert('error', 'Delete failed', msg);
      deleteBtn.disabled = false;
    } finally {
      hideLoader();
    }
  });
};

// =========================
// Cancel buttons
// =========================

/**
 * Set up cancel buttons for both create and edit modes.
 * Clicking cancel will navigate back or to the homepage.
 *
 * @returns {void}
 */
const setupCancelButtons = () => {
  const createButtonsRow = qs('#createModeButtons');
  const editButtonsRow = qs('#editModeButtons');

  if (createButtonsRow) {
    const cancelBtn = createButtonsRow.querySelector('.btn-dark:not([type="submit"])');
    if (cancelBtn) {
      cancelBtn.addEventListener('click', (event) => {
        event.preventDefault();
        goBackOrHome();
      });
    }
  }

  if (editButtonsRow) {
    const cancelBtn = editButtonsRow.querySelector('.btn-outline-dark');
    if (cancelBtn) {
      cancelBtn.addEventListener('click', (event) => {
        event.preventDefault();
        goBackOrHome();
      });
    }
  }
};

// =========================
// Add extra media fields
// =========================

/**
 * Set up the "Add another image" button.
 *
 * Each click will clone the first media group and increment the index.
 *
 * @returns {void}
 */
const setupMediaAddButton = () => {
  const container = qs('#mediaFieldsContainer');
  const addBtn = qs('.sb-btn-add-image');
  if (!container || !addBtn) return;

  const firstGroup = container.querySelector('.sb-media-group');
  if (!firstGroup) return;

  let count = container.querySelectorAll('.sb-media-group').length || 1;

  addBtn.addEventListener('click', () => {
    count += 1;
    createMediaGroup(container, firstGroup, count, null);
  });
};

// =========================
// Live preview (title + first image)
// =========================

/**
 * Set up the live preview card for the listing:
 * - Updates title as the user types
 * - Updates the first preview image based on the first media URL + alt
 *
 * @param {Object} auth - Current auth object (contains user name).
 * @returns {void}
 */
const setupPreview = (auth) => {
  const titleInput = qs('#listingTitle');
  const previewTitleEl = qs('#previewTitle');
  const previewUsernameEl = qs('#previewUsername');

  const mediaContainer = qs('#mediaFieldsContainer');
  const firstUrlInput = mediaContainer ? mediaContainer.querySelector('[data-media-url]') : null;
  const firstAltInput = mediaContainer ? mediaContainer.querySelector('[data-media-alt]') : null;

  const previewImageWrapper = qs('[data-preview-image-wrapper]');
  const previewImageEl = qs('[data-preview-img]');
  const previewPlaceholderEl = qs('[data-preview-placeholder]');

  if (previewUsernameEl &amp;&amp; auth &amp;&amp; auth.name) {
    previewUsernameEl.textContent = auth.name;
  }

  const updatePreviewTitle = () => {
    if (!titleInput || !previewTitleEl) return;
    const value = String(titleInput.value || '').trim();
    previewTitleEl.textContent = value || 'Listing title';
  };

  const updatePreviewImage = () => {
    if (!previewImageWrapper || !previewImageEl || !firstUrlInput) return;

    const url = getTrimmedInputValue(firstUrlInput);
    const altFromInput = firstAltInput ? getTrimmedInputValue(firstAltInput) : '';
    const fallbackAlt = previewTitleEl ? previewTitleEl.textContent : 'Listing image';
    const alt = altFromInput || fallbackAlt || 'Listing image';

    if (url) {
      previewImageEl.src = url;
      previewImageEl.alt = alt;
      previewImageEl.classList.remove('d-none');
      if (previewPlaceholderEl) {
        previewPlaceholderEl.classList.add('d-none');
      }
    } else {
      previewImageEl.src = '';
      previewImageEl.alt = '';
      previewImageEl.classList.add('d-none');
      if (previewPlaceholderEl) {
        previewPlaceholderEl.classList.remove('d-none');
      }
    }
  };

  if (titleInput &amp;&amp; previewTitleEl) {
    titleInput.addEventListener('input', updatePreviewTitle);
    updatePreviewTitle();
  }

  if (firstUrlInput) {
    firstUrlInput.addEventListener('input', updatePreviewImage);
  }
  if (firstAltInput) {
    firstAltInput.addEventListener('input', updatePreviewImage);
  }

  // For edit mode after prefill
  updatePreviewImage();
};

// =========================
// Form helpers: read + validate
// =========================

/**
 * Read all main fields from the listing form.
 *
 * @returns {{title: string, description: string, tagsRaw: string, endsAtRaw: string}}
 *  Object with trimmed form values.
 */
const getListingFormData = () => {
  const titleInput = qs('#listingTitle');
  const descriptionInput = qs('#listingDescription');
  const tagsInput = qs('#listingTags');
  const endsAtInput = qs('#listingEndsAt');

  const title = getTrimmedInputValue(titleInput);
  const description = getTrimmedInputValue(descriptionInput);
  const tagsRaw = getTrimmedInputValue(tagsInput);
  const endsAtRaw = getTrimmedInputValue(endsAtInput);

  return { title: title, description: description, tagsRaw: tagsRaw, endsAtRaw: endsAtRaw };
};

/**
 * Validate the listing form data.
 *
 * Checks:
 * - Title, description and end time are filled in
 * - End time is a valid date
 * - End time is in the future
 *
 * @param {{title: string, description: string, endsAtRaw: string}} data - Listing form data.
 * @returns {string|null} Error message if invalid, otherwise null.
 */
const validateListingData = ({ title, description, endsAtRaw }) => {
  if (!title || !description || !endsAtRaw) {
    return 'Please fill in title, description and end date/time.';
  }

  const endsAtDate = new Date(endsAtRaw);
  if (Number.isNaN(endsAtDate.getTime())) {
    return 'Please choose a valid end date and time.';
  }

  const now = new Date();
  if (endsAtDate &lt;= now) {
    return 'Auction end time must be in the future.';
  }

  return null;
};

// =========================
// Form submit (create + update)
// =========================

/**
 * Set up the submit handler for the listing form.
 *
 * Handles both:
 * - Create mode (no listingId)
 * - Edit mode (existing listingId, only owner can edit)
 *
 * @param {boolean} isEditMode - True if editing an existing listing.
 * @param {string|null} listingId - Listing ID, or null in create mode.
 * @param {string|null} listingOwnerName - Name of the listing owner.
 * @returns {void}
 */
const setupFormSubmit = (isEditMode, listingId, listingOwnerName) => {
  const form = qs('[data-listing-edit-form]');
  if (!form) return;

  const submitBtnCreateRow = qs('#createModeButtons button[type="submit"]');
  const submitBtnEditRow = qs('#editModeButtons button[type="submit"]');

  form.addEventListener('submit', async (event) => {
    event.preventDefault();
    clearInlineMessage();

    const currentAuth = getAuth();

    if (!currentAuth || !currentAuth.name) {
      clearAuth();
      showAlert('error', 'Login required', 'You must be logged in to create or edit listings.');
      setTimeout(() => {
        redirectToLogin();
      }, 800);
      return;
    }

    if (isEditMode &amp;&amp; listingOwnerName &amp;&amp; listingOwnerName !== currentAuth.name) {
      showAlert('error', 'Not allowed', 'You can only edit your own listings.');
      return;
    }

    const { title, description, tagsRaw, endsAtRaw } = getListingFormData();
    const validationError = validateListingData({ title, description, endsAtRaw });

    if (validationError) {
      showInlineMessage(validationError, 'error');
      return;
    }

    const endsAtDate = new Date(endsAtRaw);

    const payload = {
      title: title,
      description: description,
      endsAt: endsAtDate.toISOString(),
    };

    const tags = buildTagsArray(tagsRaw);
    if (tags) {
      payload.tags = tags;
    }

    const media = buildMediaArrayFromForm(form);
    if (media) {
      payload.media = media;
    }

    const submitBtn = isEditMode ? submitBtnEditRow : submitBtnCreateRow;
    if (submitBtn) {
      submitBtn.disabled = true;
      submitBtn.textContent = isEditMode ? 'Saving…' : 'Creating…';
    }

    showLoader();

    try {
      if (isEditMode &amp;&amp; listingId) {
        await updateListing(listingId, payload);

        showInlineMessage('Your listing has been updated.', 'success');
        showAlert('success', 'Listing updated', 'Your listing has been updated.');

        setTimeout(() => {
          window.location.href = 'listing.html?id=' + encodeURIComponent(listingId);
        }, 900);
      } else {
        const created = await createListing(payload);
        const newId = created &amp;&amp; created.id ? created.id : null;

        showInlineMessage('Your listing has been created.', 'success');
        showAlert('success', 'Listing created', 'Your listing has been created.');

        if (newId) {
          setTimeout(() => {
            window.location.href = 'listing.html?id=' + encodeURIComponent(newId);
          }, 900);
        }
      }
    } catch (error) {
      const msg =
        error &amp;&amp; error.message
          ? error.message
          : 'Could not save your listing. Please check the form and try again.';
      showInlineMessage(msg, 'error');
      showAlert('error', isEditMode ? 'Update failed' : 'Create failed', msg);
    } finally {
      hideLoader();
      if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.textContent = isEditMode ? 'Save changes' : 'Create listing';
      }
    }
  });
};

// =========================
// Init
// =========================

/**
 * Initialize the listing create/edit page.
 *
 * - Requires the user to be logged in
 * - Checks if we are in create or edit mode (based on URL id)
 * - In edit mode: loads listing, checks ownership, pre-fills the form
 *
 * @returns {Promise&lt;void>}
 */
const initListingEditPage = async () => {
  const auth = getAuth();

  if (!auth || !auth.name) {
    showAlert('error', 'Login required', 'You must be logged in to create or edit listings.');
    setTimeout(() => {
      redirectToLogin();
    }, 800);
    return;
  }

  const listingId = getListingIdFromQuery();
  const isEditMode = !!listingId;

  const titleHeadingEl = qs('#listingFormTitle');

  if (titleHeadingEl) {
    titleHeadingEl.textContent = isEditMode ? 'Edit listing' : 'Create a new listing';
  }

  setupButtonsForMode(isEditMode);
  setupCancelButtons();
  setupMediaAddButton();

  if (!isEditMode) {
    setupPreview(auth);
    setupFormSubmit(false, null, null);
    return;
  }

  // Edit mode: load listing and check owner

  showLoader();

  try {
    const listing = await getListingById(listingId, '?_seller=true');

    if (!listing) {
      showAlert('error', 'Not found', 'This listing could not be found.');
      window.location.href = 'index.html';
      return;
    }

    const ownerName = listing.seller &amp;&amp; listing.seller.name ? listing.seller.name : null;

    if (!ownerName || ownerName !== auth.name) {
      showAlert('error', 'Not allowed', 'You can only edit your own listings.');
      window.location.href = 'index.html';
      return;
    }

    prefillFormFromListing(listing);
    setupPreview(auth);
    setupDeleteInEditMode(listingId);
    setupFormSubmit(true, listingId, ownerName);
  } catch (error) {
    const msg =
      error &amp;&amp; error.message
        ? error.message
        : 'Could not load this listing for editing. Please try again.';
    showAlert('error', 'Error', msg);
    window.location.href = 'index.html';
  } finally {
    hideLoader();
  }
};

// =========================
// Run
// =========================

initListingEditPage();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#BASE_API_URL">BASE_API_URL</a></li><li><a href="global.html#NOROFF_API_KEY">NOROFF_API_KEY</a></li><li><a href="global.html#PAGE_SIZE">PAGE_SIZE</a></li><li><a href="global.html#activateTab">activateTab</a></li><li><a href="global.html#activateTabFromHash">activateTabFromHash</a></li><li><a href="global.html#addBaseListingParams">addBaseListingParams</a></li><li><a href="global.html#addSortParams">addSortParams</a></li><li><a href="global.html#addToLocalStorage">addToLocalStorage</a></li><li><a href="global.html#avatarAltInput">avatarAltInput</a></li><li><a href="global.html#avatarDesktopWrapper">avatarDesktopWrapper</a></li><li><a href="global.html#avatarMobileWrapper">avatarMobileWrapper</a></li><li><a href="global.html#avatarUrlInput">avatarUrlInput</a></li><li><a href="global.html#bannerAltInput">bannerAltInput</a></li><li><a href="global.html#bannerEl">bannerEl</a></li><li><a href="global.html#bannerUrlInput">bannerUrlInput</a></li><li><a href="global.html#bioInput">bioInput</a></li><li><a href="global.html#buildApiUrl">buildApiUrl</a></li><li><a href="global.html#buildAvatarPayload">buildAvatarPayload</a></li><li><a href="global.html#buildListingsQueryString">buildListingsQueryString</a></li><li><a href="global.html#buildMediaArrayFromForm">buildMediaArrayFromForm</a></li><li><a href="global.html#buildSearchQueryString">buildSearchQueryString</a></li><li><a href="global.html#buildTagQueryString">buildTagQueryString</a></li><li><a href="global.html#buildTagsArray">buildTagsArray</a></li><li><a href="global.html#clearAuth">clearAuth</a></li><li><a href="global.html#clearEditMessage">clearEditMessage</a></li><li><a href="global.html#clearElement">clearElement</a></li><li><a href="global.html#clearError">clearError</a></li><li><a href="global.html#clearFieldsState">clearFieldsState</a></li><li><a href="global.html#clearInlineMessage">clearInlineMessage</a></li><li><a href="global.html#clearListings">clearListings</a></li><li><a href="global.html#createEndedBadge">createEndedBadge</a></li><li><a href="global.html#createListing">createListing</a></li><li><a href="global.html#createListingCard">createListingCard</a></li><li><a href="global.html#createMediaGroup">createMediaGroup</a></li><li><a href="global.html#createWonBadge">createWonBadge</a></li><li><a href="global.html#deleteListing">deleteListing</a></li><li><a href="global.html#disableBidForm">disableBidForm</a></li><li><a href="global.html#editCancelButton">editCancelButton</a></li><li><a href="global.html#editMessageEl">editMessageEl</a></li><li><a href="global.html#editProfileButton">editProfileButton</a></li><li><a href="global.html#editProfileForm">editProfileForm</a></li><li><a href="global.html#editProfileSection">editProfileSection</a></li><li><a href="global.html#ensureAlertContainer">ensureAlertContainer</a></li><li><a href="global.html#ensureDefaultFeedbackText">ensureDefaultFeedbackText</a></li><li><a href="global.html#errorMessageFrom">errorMessageFrom</a></li><li><a href="global.html#extractBidErrorMessage">extractBidErrorMessage</a></li><li><a href="global.html#fetchAndApplyProfile">fetchAndApplyProfile</a></li><li><a href="global.html#fetchListings">fetchListings</a></li><li><a href="global.html#fetchSearchListings">fetchSearchListings</a></li><li><a href="global.html#formatEndsIn">formatEndsIn</a></li><li><a href="global.html#formatTimeLeft">formatTimeLeft</a></li><li><a href="global.html#getAccessToken">getAccessToken</a></li><li><a href="global.html#getAuth">getAuth</a></li><li><a href="global.html#getCurrentUser">getCurrentUser</a></li><li><a href="global.html#getFromLocalStorage">getFromLocalStorage</a></li><li><a href="global.html#getHighestBidAmount">getHighestBidAmount</a></li><li><a href="global.html#getInitials">getInitials</a></li><li><a href="global.html#getListingById">getListingById</a></li><li><a href="global.html#getListingFormData">getListingFormData</a></li><li><a href="global.html#getListingIdFromQuery">getListingIdFromQuery</a></li><li><a href="global.html#getListings">getListings</a></li><li><a href="global.html#getOrCreateBidErrorElement">getOrCreateBidErrorElement</a></li><li><a href="global.html#getProfile">getProfile</a></li><li><a href="global.html#getProfileBids">getProfileBids</a></li><li><a href="global.html#getProfileNameFromQuery">getProfileNameFromQuery</a></li><li><a href="global.html#getProfileWins">getProfileWins</a></li><li><a href="global.html#getRelevanceScore">getRelevanceScore</a></li><li><a href="global.html#getSortedBids">getSortedBids</a></li><li><a href="global.html#getTrimmedField">getTrimmedField</a></li><li><a href="global.html#getTrimmedInputValue">getTrimmedInputValue</a></li><li><a href="global.html#goBackOrHome">goBackOrHome</a></li><li><a href="global.html#hasHeader">hasHeader</a></li><li><a href="global.html#headerAvatarEls">headerAvatarEls</a></li><li><a href="global.html#headerCreditsEls">headerCreditsEls</a></li><li><a href="global.html#headerLoggedIn">headerLoggedIn</a></li><li><a href="global.html#headerLoggedOut">headerLoggedOut</a></li><li><a href="global.html#hideEditSection">hideEditSection</a></li><li><a href="global.html#hideEndOfResults">hideEndOfResults</a></li><li><a href="global.html#hideLoader">hideLoader</a></li><li><a href="global.html#initHeader">initHeader</a></li><li><a href="global.html#initListingDetailsPage">initListingDetailsPage</a></li><li><a href="global.html#initListingEditPage">initListingEditPage</a></li><li><a href="global.html#initProfilePage">initProfilePage</a></li><li><a href="global.html#inlineMessageEl">inlineMessageEl</a></li><li><a href="global.html#isAuctionEnded">isAuctionEnded</a></li><li><a href="global.html#isListingEnded">isListingEnded</a></li><li><a href="global.html#isNewListing">isNewListing</a></li><li><a href="global.html#isNonEmptyString">isNonEmptyString</a></li><li><a href="global.html#justLoggedInFlag">justLoggedInFlag</a></li><li><a href="global.html#loaderEl">loaderEl</a></li><li><a href="global.html#loginUser">loginUser</a></li><li><a href="global.html#logoutUser">logoutUser</a></li><li><a href="global.html#normaliseMediaItem">normaliseMediaItem</a></li><li><a href="global.html#normalizeHeaders">normalizeHeaders</a></li><li><a href="global.html#normalizeToken">normalizeToken</a></li><li><a href="global.html#parseDate">parseDate</a></li><li><a href="global.html#placeBid">placeBid</a></li><li><a href="global.html#prefillFormFromListing">prefillFormFromListing</a></li><li><a href="global.html#profileBioEl">profileBioEl</a></li><li><a href="global.html#profileTitleEl">profileTitleEl</a></li><li><a href="global.html#qs">qs</a></li><li><a href="global.html#redirectToLogin">redirectToLogin</a></li><li><a href="global.html#refreshHeaderFromProfile">refreshHeaderFromProfile</a></li><li><a href="global.html#registerUser">registerUser</a></li><li><a href="global.html#removeFromLocalStorage">removeFromLocalStorage</a></li><li><a href="global.html#renderAvatarInto">renderAvatarInto</a></li><li><a href="global.html#renderBidHistory">renderBidHistory</a></li><li><a href="global.html#renderHeaderAvatarFrom">renderHeaderAvatarFrom</a></li><li><a href="global.html#renderListing">renderListing</a></li><li><a href="global.html#renderListingMedia">renderListingMedia</a></li><li><a href="global.html#renderListings">renderListings</a></li><li><a href="global.html#renderMyBids">renderMyBids</a></li><li><a href="global.html#renderMyListings">renderMyListings</a></li><li><a href="global.html#renderMyWins">renderMyWins</a></li><li><a href="global.html#renderOwnerEditButton">renderOwnerEditButton</a></li><li><a href="global.html#request">request</a></li><li><a href="global.html#safeJsonParseAuth">safeJsonParseAuth</a></li><li><a href="global.html#safeJsonParseResponse">safeJsonParseResponse</a></li><li><a href="global.html#safeJsonStringify">safeJsonStringify</a></li><li><a href="global.html#saveAuth">saveAuth</a></li><li><a href="global.html#searchListings">searchListings</a></li><li><a href="global.html#setFieldState">setFieldState</a></li><li><a href="global.html#setText">setText</a></li><li><a href="global.html#setupBidForm">setupBidForm</a></li><li><a href="global.html#setupButtonsForMode">setupButtonsForMode</a></li><li><a href="global.html#setupCancelButtons">setupCancelButtons</a></li><li><a href="global.html#setupDeleteInEditMode">setupDeleteInEditMode</a></li><li><a href="global.html#setupEditProfileForm">setupEditProfileForm</a></li><li><a href="global.html#setupFormSubmit">setupFormSubmit</a></li><li><a href="global.html#setupMediaAddButton">setupMediaAddButton</a></li><li><a href="global.html#setupMyListingCardActions">setupMyListingCardActions</a></li><li><a href="global.html#setupPreview">setupPreview</a></li><li><a href="global.html#showAlert">showAlert</a></li><li><a href="global.html#showEditMessage">showEditMessage</a></li><li><a href="global.html#showEditSection">showEditSection</a></li><li><a href="global.html#showEndOfResults">showEndOfResults</a></li><li><a href="global.html#showError">showError</a></li><li><a href="global.html#showInlineMessage">showInlineMessage</a></li><li><a href="global.html#showLoader">showLoader</a></li><li><a href="global.html#sortComparators">sortComparators</a></li><li><a href="global.html#sortConfig">sortConfig</a></li><li><a href="global.html#sortNonSearchResults">sortNonSearchResults</a></li><li><a href="global.html#sortSearchResults">sortSearchResults</a></li><li><a href="global.html#toDateTimeLocalValue">toDateTimeLocalValue</a></li><li><a href="global.html#toReadableDateTime">toReadableDateTime</a></li><li><a href="global.html#updateAvatar">updateAvatar</a></li><li><a href="global.html#updateHeaderCredits">updateHeaderCredits</a></li><li><a href="global.html#updateHeaderState">updateHeaderState</a></li><li><a href="global.html#updateListing">updateListing</a></li><li><a href="global.html#updateProfile">updateProfile</a></li><li><a href="global.html#updateProfileHero">updateProfileHero</a></li><li><a href="global.html#updateSummary">updateSummary</a></li><li><a href="global.html#validateListingData">validateListingData</a></li><li><a href="global.html#validateLoginFields">validateLoginFields</a></li><li><a href="global.html#validateNoroffEmail">validateNoroffEmail</a></li><li><a href="global.html#validateRegisterFields">validateRegisterFields</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Wed Dec 10 2025 08:27:34 GMT+0100 (centraleuropeisk normaltid)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
